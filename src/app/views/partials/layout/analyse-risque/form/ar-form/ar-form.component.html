<ng-container [formGroup]="arForm">
	<div class="row" [hidden]="origin == 'add' && partHided(1)">
		<div class="col-12">
			<div class="tf-heading tf-heading--md">| 1 Règles générales du chantier</div>
			<div class="row">
				<div class="col-md-7">
					<div class="tf-card-form">
						<div class="tf-heading tf-heading--sm">
							1.1 Accueil sécurité propre au client
						</div>
						<div class="row form-row mb-4">
							<mat-slide-toggle class="col-xl-12" 
							labelPosition="before" 
							formControlName="a_prevoir_compagnons">
								{{'ARS.PREVOIR_COMPAGNONS.LABEL' | translate}}
							</mat-slide-toggle>
						</div>
						<div class="row form-row">
							<mat-form-field class="col-xl-5" >
								<mat-label>{{'ARS.DATE_ACCUEIL_SECU.LABEL' | translate}}</mat-label>
								<input matInput class="form-control" [matDatepicker]="date_accueil_secu_picker" formControlName="date_accueil_secu" placeholder="DD/MM/YYYY">
								<mat-datepicker-toggle matSuffix [for]="date_accueil_secu_picker"></mat-datepicker-toggle>
								<mat-datepicker #date_accueil_secu_picker></mat-datepicker>
							</mat-form-field>
							<mat-form-field class="col-xl-4" >
								<mat-label>{{'ARS.DATE_VALIDITE.LABEL' | translate}}</mat-label>
								<input matInput class="form-control" [matDatepicker]="date_validite_picker" formControlName="date_validite" placeholder="DD/MM/YYYY">
								<mat-datepicker-toggle matSuffix [for]="date_validite_picker"></mat-datepicker-toggle>
								<mat-datepicker #date_validite_picker></mat-datepicker>
							</mat-form-field>
						</div>
						<div class="row form-row">
							<div class="col-xl-5 mat-form-field ng-tns-c14-2 mat-primary mat-form-field-type-mat-input mat-form-field-appearance-legacy mat-form-field-can-float mat-form-field-should-float mat-form-field-has-label" formContolName="a_prevoir_compagnons">
								<div class="mat-form-field-wrapper">
									<div class="mat-form-field-flex">
										<div class="mat-form-field-infix">
											<span class="mat-form-field-label-wrapper">
												<label class="mat-form-field-label">{{'ARS.AS_HORAIRES.LABEL' | translate}}</label>
											</span>
											<div class="horaire-box">
												<div>
													<input class="form-control text-center" type="time" name="accueil_secu_time_opening" formControlName="accueil_secu_time_opening" />
												</div>
												<span>A </span>
												<div>
													<input class="form-control text-center" type="time" name="accueil_secu_time_closing" formControlName="accueil_secu_time_closing" placeholder="" />
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
							<mat-form-field class="col-xl-7">
								<mat-label>{{'ARS.AS_DAYS.LABEL' | translate}}</mat-label>
								<mat-select class="form-control" formControlName="accueil_secu_days" multiple>
									<mat-select-trigger>
										<mat-chip-list #chipList>
											<mat-chip *ngFor="let as_day of toppings.value" class="chip-item">
												{{as_day}}
											</mat-chip>
										</mat-chip-list>
									</mat-select-trigger>
									<mat-option *ngFor="let topping of toppingList" [value]="topping">{{topping}}</mat-option>
								</mat-select>
							</mat-form-field>
						</div>
						<div class="row form-row">
							<mat-form-field class="col-xl-5" >
								<mat-label>{{'ARS.REALISATEUR.LABEL' | translate}}</mat-label>
								<input class="form-control" matInput type="text" name="realisateur" formControlName="realisateur" placeholder="Saisir ici" />
							</mat-form-field>
							<mat-form-field class="col-xl-4" >
								<mat-label>{{'ARS.TEL_REALISATEUR.LABEL' | translate}}</mat-label>
								<input class="form-control" matInput pattern="[0-9+ ]*" type="tel" name="tel_realisateur" formControlName="tel_realisateur" placeholder="Saisir ici" />
							</mat-form-field>
						</div>
						<div class="row form-row">
							<mat-form-field class="col-xl-5" >
								<mat-label>{{'ARS.CONTACT_INTERNE_SECOURS.LABEL' | translate}}</mat-label>
								<input class="form-control" matInput type="text" name="contact_interne_secours" formControlName="contact_interne_secours" placeholder="Saisir ici" />
							</mat-form-field>
							<mat-form-field class="col-xl-4" >
								<mat-label>{{'ARS.TEL_CONTACT_INTERNE_SECOURS.LABEL' | translate}}</mat-label>
								<input class="form-control" matInput pattern="[0-9+ ]*" type="tel" name="tel_contact_interne_secours" formControlName="tel_contact_interne_secours" placeholder="Saisir ici" />
							</mat-form-field>
							<mat-form-field class="col-xl-3" >
								<mat-label>{{'ARS.NUM_SECOURS.LABEL' | translate}}</mat-label>
								<input class="form-control" matInput pattern="[0-9+ ]*" type="tel" name="num_secours" formControlName="num_secours" placeholder="Saisir ici" />
							</mat-form-field>
						</div>
					</div>
				</div>
				<div class="col-md-5">
					<div class="row">
						<div class="col-md-12">
							<div class="tf-card-form">
								<div class="tf-heading tf-heading--sm">
									1.2 Contacts client
								</div>
								<div class="row">
									<mat-form-field class="col-xl-6" >
										<mat-label>{{'ARS.CONTACT_CLIENT_CHEF_CHANTIER.LABEL' | translate}}</mat-label>
										<input class="form-control" matInput type="text" name="contact_client_chef_chtr" formControlName="contact_client_chef_chtr" placeholder="Saisir ici" />
									</mat-form-field>
									<mat-form-field class="col-xl-6" >
										<mat-label>{{'ARS.TEL_CONTACT_CLIENT_CHEF_CHANTIER.LABEL' | translate}}</mat-label>
										<input class="form-control" matInput pattern="[0-9+ ]*" type="tel" name="tel_contact_client_chef_chtr" formControlName="tel_contact_client_chef_chtr" placeholder="Saisir ici" />
									</mat-form-field>
									<mat-form-field class="col-xl-6" >
										<mat-label>{{'ARS.CONTACT_CLIENT_HSE.LABEL' | translate}}</mat-label>
										<input class="form-control" matInput type="text" name="contact_client_hse" formControlName="contact_client_hse" placeholder="Saisir ici" />
									</mat-form-field>
									<mat-form-field class="col-xl-6" >
										<mat-label>{{'ARS.TEL_CONTACT_CLIENT_HSE.LABEL' | translate}}</mat-label>
										<input class="form-control" matInput pattern="[0-9+ ]*" type="tel" name="tel_contact_client_hse" formControlName="tel_contact_client_hse" placeholder="Saisir ici" />
									</mat-form-field>
								</div>
							</div>
						</div>
						<div class="col-md-12">
							<div class="tf-card-form">
								<div class="tf-heading tf-heading--sm">
									1.3 Conditions générales du chantier
								</div>
								<div class="row">
									<div class="col-xl-7 mat-form-field ng-tns-c14-2 mat-primary mat-form-field-type-mat-input mat-form-field-appearance-legacy mat-form-field-can-float mat-form-field-should-float mat-form-field-has-label" formContolName="a_prevoir_compagnons">
										<div class="mat-form-field-wrapper">
											<div class="mat-form-field-flex">
												<div class="mat-form-field-infix">
													<span class="mat-form-field-label-wrapper">
														<label class="mat-form-field-label">{{'ARS.HORAIRES.LABEL' | translate}}</label>
													</span>
													<div class="horaire-box">
														<div>
															<input class="form-control text-center" type="time" name="heure_ouverture" formControlName="heure_ouverture" />
														</div>
														<span>A </span>
														<div>
															<input class="form-control text-center" type="time" name="heure_fermeture" formControlName="heure_fermeture" placeholder="" />
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
									<mat-form-field class="col-xl-5" >
										<mat-label>{{'ARS.COURANT.LABEL' | translate}}</mat-label>
										<input class="form-control" matInput type="text" name="courant_dispo" formControlName="courant_dispo" placeholder="Ex: 180 kWh" />
									</mat-form-field>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

		</div>
		<div class="col-12 my-4">
			<button mat-raised-button type="button" class="pull-right btn-small" color="info" *ngIf="partHided('1b') && origin=='add'" (click)="showPart('1b')">Suite</button>
		</div>
	</div>

	<div class="row" [hidden]="origin == 'add' && partHided('1b')">
		<div class="col-12">
			<div class="row">
				<div class="col-md-6" *ngFor="let zoneType of zonesList |  keyvalue; let i = index">
					<div class="tf-card-form">
						<div class="tf-heading tf-heading--sm">
							1.{{i+4}} {{zoneType.key}}
						</div>
						<div class="form-row row">
							<div class="col-xl-6"*ngFor="let zone of zoneType.value">
								<mat-checkbox [value]="zone.id" (change)="onZoneCheckChange($event)" [checked]="onZoneIsChecked(zone.id)" >{{zone.libelle}}</mat-checkbox>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="col-12 my-4">
			<button mat-raised-button type="button" class="pull-right btn-small" color="info" *ngIf="partHided(2) && origin=='add'" (click)="showPart(2)">Suite</button>
		</div>
	</div>

	<div class="row" [hidden]="origin == 'add' && partHided(2)">		
		<div class="col-12">
			<div class="tf-heading tf-heading--md">| 2 {{'ARS.FORM.RISKBLOCK.TITLE' | translate}}</div>
			<div class="row">
				<div class="col-md-12">
					<div class="tf-card-form">
						<div class="tf-heading tf-heading--sm">
							{{'ARS.FORM.RISKBLOCK.MSG' | translate}}
						</div>
						<div class="row form-row"></div>
						<table mat-table [dataSource]="risksList">
		
							<ng-container matColumnDef="risks">
								<th mat-header-cell *matHeaderCellDef> {{'ARS.FORM.RISKS' | translate}} </th>
								<td mat-cell *matCellDef="let element"> {{element.libelle}} </td>
							</ng-container>
		
							<ng-container matColumnDef="actions">
								<th mat-header-cell *matHeaderCellDef> {{'ARS.FORM.ACTION' | translate}} </th>
								<td mat-cell *matCellDef="let element">
									<div class="m-2" *ngFor="let risk of element.risques">
										<mat-checkbox [value]="risk.id" (change)="onRiskCheckChange($event)" [checked]="onRiskIsChecked(risk.id)">{{risk.libelle}}</mat-checkbox>
									</div>
								</td>
							</ng-container>
		
							<!-- Weight Column -->
							<ng-container matColumnDef="comments">
								<th mat-header-cell *matHeaderCellDef> {{'ARS.FORM.COMMENT' | translate}} </th>
								<td mat-cell *matCellDef="let element">
									<div class="full-height">
										<textarea class="form-control no_border full-height" (change)="onCommentCheckChange(element.id,$event)" [value]="getCommentValue(element.id)" placeholder="Saisir ici"></textarea>
									</div>
								</td>
							</ng-container>
		
		
							<tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
							<tr mat-row *matRowDef="let row; columns: displayedColumns;" ></tr>
						</table>
					</div>
				</div>
			</div>
		</div>
		<div class="col-12 my-4">
			<button mat-raised-button type="button" class="pull-right btn-small" color="info" *ngIf="partHided(3) && origin=='add'" (click)="showPart(3)">Suite</button>
		</div>
	</div>
	<div class="row" [hidden]="origin == 'add' && partHided(3)">		
		<div class="col-12">
			<div class="tf-heading tf-heading--md">| 3 {{'ARS.FORM.EQBLOCK.TITLE' | translate}}</div>
			<div class="row">
				<div class="col-md-12">
					<div class="tf-card-form">
						<div class="form-row">
							<div class="col-md-2" *ngFor="let equipement of equipementList">
								<mat-checkbox [value]="equipement.id" (change)="onEquipementCheckChange($event)" [checked]="onEquipementIsChecked(equipement.id)">{{equipement.libelle}}</mat-checkbox>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="col-12 my-4">
			<button mat-raised-button type="button" class="pull-right btn-small" color="info" *ngIf="partHided(4) && origin=='add'" (click)="showPart(4)">Suite</button>
		</div>
	</div>
	<div class="row" [hidden]="origin == 'add' && partHided(4)">		
		<div class="col-12">
			<div class="tf-heading tf-heading--md">| 4 {{'ARS.FORM.MWBLOCK.TITLE' | translate}}</div>
			<div class="row">
				<div class="col-md-6">
					<div class="tf-card-form">
						<div class="tf-heading tf-heading--sm">
							{{'ARS.FORM.MWBLOCK.WORKREGISTER.TITLE' | translate}}
						</div>
						<div class="row form-row">
							<mat-radio-group formControlName="a_signer_registre_travaux" class="col-xl-12 col-md-12 mat-form-field ng-tns-c14-2 mat-primary mat-form-field-type-mat-input mat-form-field-appearance-legacy mat-form-field-can-float mat-form-field-should-float mat-form-field-has-label">
								<div class="mat-form-field-wrapper">
									<div class="mat-form-field-flex">
										<div class="mat-form-field-infix col-md-3">
											<span class="mat-form-field-label-wrapper">
												<label class="mat-form-field-label"></label>
											</span>
											<div class="form-control mat-input-element mat-radio-box">
												<mat-radio-button value="1">Oui</mat-radio-button>
												<mat-radio-button value="0">Non</mat-radio-button>
											</div>
										</div>
										<label>{{'ARS.FORM.MWBLOCK.WORKREGISTER.MSG' | translate}}</label>
									</div>
								</div>
							</mat-radio-group>
						</div>
						<div class="row form-row" *ngIf="isChecked('a_signer_registre_travaux')">
							<mat-radio-group  formControlName="registre_signing_period"
							class="col-xl-12 col-md-12 mat-form-field ng-tns-c14-2 mat-primary mat-form-field-type-mat-input mat-form-field-appearance-legacy mat-form-field-can-float mat-form-field-should-float mat-form-field-has-label">
								<div class="mat-form-field-wrapper">
									<div class="mat-form-field-flex">
										<div class="mat-form-field-infix">
											<span class="mat-form-field-label-wrapper">
												<label class="mat-form-field-label">{{'ARS.ASIGNER.LABEL' | translate}}</label>
											</span>
											<div class="form-control mat-input-element mat-radio-box" style="justify-content: end">
												<mat-radio-button value="quotidiennement">{{'ARS.QUOTIDIENNEMENT.LABEL' | translate}}</mat-radio-button>
												<mat-radio-button value="par 1/2 journée">{{'ARS.DEMIJOURNEE.LABEL' | translate}}</mat-radio-button>
												<mat-radio-button value="toute les 2h">{{'ARS.DEUXHEURES.LABEL' | translate}}</mat-radio-button>
											</div>
										</div>
									</div>
								</div>
							</mat-radio-group>
						</div>
						<div class="row form-row" *ngIf="isChecked('a_signer_registre_travaux')">
							<mat-form-field class="col-xl-7">
								<mat-label>{{'ARS.FORM.REGISTRAR' | translate}}</mat-label>
								<input class="form-control" matInput type="text" name="nom_charge_registre" formControlName="nom_charge_registre" placeholder="Saisir ici" />
							</mat-form-field>
							<mat-form-field class="col-xl-5">
								<mat-label>{{'COMMON.PHONENUMBER.LABEL' | translate}}</mat-label>
								<input class="form-control" matInput  pattern="[0-9+ ]*" type="tel" name="tel_charge_registre" formControlName="tel_charge_registre" placeholder="Saisir ici" />
							</mat-form-field>
						</div>
						<div class="row form-row" *ngIf="isChecked('a_signer_registre_travaux')">
							<mat-form-field class="col-xl-7">
								<mat-label>{{'COMMON.ADRESS.LABEL' | translate}}</mat-label>
								<input class="form-control" matInput type="text" name="adresse_charge_registre" formControlName="adresse_charge_registre" placeholder="Saisir ici" />
							</mat-form-field>
							<mat-form-field class="col-xl-5">
								<mat-label>{{'COMMON.CITY.LABEL' | translate}}</mat-label>
								<input class="form-control" matInput type="text" name="ville_charge_registre" formControlName="ville_charge_registre" placeholder="Saisir ici" />
							</mat-form-field>
						</div>
						<div class="row form-row" *ngIf="isChecked('a_signer_registre_travaux')">
							<mat-form-field class="col-xl-7">
								<mat-label>{{'COMMON.POSTCODE.LABEL' | translate}}</mat-label>
								<input matInput class="form-control" type="text" name="codepostal_charge_registre" formControlName="codepostal_charge_registre" placeholder="Saisir ici" />
							</mat-form-field>
							<mat-form-field class="col-xl-5">
								<mat-label>{{'COMMON.COUNTRY.LABEL' | translate}}</mat-label>
								<input class="form-control" matInput type="text" name="pays_charge_registre" formControlName="pays_charge_registre" placeholder="Saisir ici" />
							</mat-form-field>
						</div>
		
					</div>
				</div>
				<div class="col-md-6">
					<div class="tf-card-form">
						<div class="tf-heading tf-heading--sm">
							{{'ARS.FORM.MWBLOCK.SUBTITLE2' | translate}}
						</div>
						<div class="row form-row">
							<mat-radio-group formControlName="a_prevoir_balisage" class="col-xl-12 col-md-12 mat-form-field ng-tns-c14-2 mat-primary mat-form-field-type-mat-input mat-form-field-appearance-legacy mat-form-field-can-float mat-form-field-should-float mat-form-field-has-label">
								<div class="mat-form-field-wrapper">
									<div class="mat-form-field-flex">
										<div class="mat-form-field-infix col-md-3">
											<span class="mat-form-field-label-wrapper">
												<label class="mat-form-field-label"></label>
											</span>
											<div class="form-control mat-input-element mat-radio-box">
												<mat-radio-button value="1">Oui</mat-radio-button>
												<mat-radio-button value="0">Non</mat-radio-button>
											</div>
										</div>
										<label>{{'ARS.FORM.MWBLOCK.WORKREGISTER.MSG' | translate}}</label>
									</div>
								</div>
							</mat-radio-group>
						</div>
		
						<div class="row form-row" *ngIf="isChecked('a_prevoir_balisage')">
							<mat-form-field class="col-xl-7">
								<mat-label>{{'ARS.FORM.CVTI_RESPONSIBLE' | translate}}</mat-label>
								<input class="form-control" matInput type="text" name="nom_ca_cvti" formControlName="nom_ca_cvti" placeholder="Saisir ici" />
							</mat-form-field>
							<mat-form-field class="col-xl-5">
								<mat-label>{{'COMMON.PHONENUMBER.LABEL' | translate}}</mat-label>
								<input class="form-control" matInput pattern="[0-9+ ]*" type="tel" name="tel_ca_cvti" formControlName="tel_ca_cvti" placeholder="Saisir ici" />
							</mat-form-field>
						</div>
		
						<div class="row form-row" *ngIf="isChecked('a_prevoir_balisage')">
							<mat-form-field class="col-xl-7">
								<mat-label>{{'ARS.FORM.CA_ASSISTANT' | translate}}</mat-label>
								<input class="form-control" matInput type="text" name="assistant_ca" formControlName="assistant_ca" placeholder="Saisir ici" />
							</mat-form-field>
							<mat-form-field class="col-xl-5">
								<mat-label>{{'COMMON.PHONENUMBER.LABEL' | translate}}</mat-label>
								<input class="form-control" matInput pattern="[0-9+ ]*" type="tel" name="tel_assistant_ca" formControlName="tel_assistant_ca" placeholder="Saisir ici" />
							</mat-form-field>
						</div>
					</div>
				</div>
			</div>
		</div>		
	</div>

	<!-- <div class="tf-heading tf-heading--md">| 5 {{'ARS.FORM.SIGNATURE.TITLE' | translate}}</div>
  <div class="row">
		<div class="col-md-12">
			<div class="tf-card-form">
				<div class="tf-heading tf-heading--sm">
					{{'ARS.FORM.SIGNATURE.SUBTITLE' | translate}}
        </div>

        <div class="row form-row">
          <mat-form-field appearance="outline"class="col-md-12" >
            <mat-label>Saisir ici votre observation</mat-label>
            <textarea matInput formControlName="observations" cdkTextareaAutosize cdkAutosizeMinRows=10 cdkAutosizeMaxRows=20></textarea>
          </mat-form-field>
        </div>

        <div class="tf-heading tf-heading--sm">
					{{'ARS.FORM.SIGNATURE.DECLARATION' | translate}}
        </div>

        <div formArrayName="signatures">
          <div>
            <p class="font-weight-bold text-right add-signature-line-btn"><a (click)="addSignatures()">+ Ajouter un signataire</a></p>
          </div>
          <div class="row form-row" *ngFor="let signature of signatures.controls; let i=index" [formGroupName]="i" >
            <div class="col-xl-2 form-row-flex" >
              <label>{{'COMMON.DATE.LABEL' | translate}} </label>
              <label style="padding-left: 0.5em;">{{curDate| date:'dd/MM/yyyy'}}</label>
            </div>
            <div class="col-xl-3 form-row-flex" >
              <label>{{'COMMON.LASTNAME.LABEL' | translate}}&nbsp;{{'COMMON.FIRSTNAME.LABEL' | translate}} </label>
              <input  class="form-control col-xl-8 no_border" type="text" name="signature_personnel" formControlName="personnel" placeholder="Saisir ici"  [matAutocomplete]="auto"/>
              <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
                <mat-option *ngFor="let salary of filteredSalaries | async" [value]="salary">
                  {{salary.fullname}}
                </mat-option>
              </mat-autocomplete>
            </div>

            <div class="col-xl-2 form-row-flex" >
              <label>{{'COMMON.SOCIETE.LABEL' | translate}} </label>
              <input class="form-control no_border" type="text" name="signature_societe" formControlName="society" placeholder="Saisir ici" />
            </div>
            <div class="col-xl-2 form-row-flex" >
              <label>{{'COMMON.SIGNATURE.LABEL' | translate}} </label>
              <input class="form-control no_border" type="text" name="signature" formControlName="signature" placeholder="Saisir ici" />
            </div>
            <div class="col-xl-2 form-row-flex" >
              <label>{{'COMMON.REMARQUE.LABEL' | translate}} </label>
              <input class="form-control no_border" type="text" name="signature_comment" formControlName="commentaires" placeholder="Saisir ici" />
            </div>

            <div class="col-xl-1" >
              <div class="sign-line-options">
                <signature-pad [options]="signaturePadOptions"  (onBeginEvent)="drawStart()" (onEndEvent)="drawComplete()"></signature-pad> 
                <div ngbDropdown placement="bottom-right" class="d-inline-block">
                  <button ngbDropdownToggle mat-icon-button color="secondary" matTooltip="Actions">
                    <mat-icon>more_vert</mat-icon>
                  </button>
                  <div ngbDropdownMenu class="dropdown-menu dropdown-menu-anim dropdown-menu-top-unround " style="min-width: max-content; padding: 5px;">
                    <button mat-icon-button color="info" matTooltip="{{'ACTION.EDIT' | translate}}" (click)="editSignature()">
                      <mat-icon>edit</mat-icon>
                    </button>
                    <button mat-icon-button color="accent" matTooltip="{{'ACTION.DELETE' | translate}}" (click)="removeSignature(i)">
                      <mat-icon>delete</mat-icon>
                    </button>
                      
                  </div>
                </div>

              </div>
            </div>
            
          </div>
        </div>

      </div>
    </div>
  </div> -->

</ng-container>
