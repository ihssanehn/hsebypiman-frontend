<form [formGroup]="arForm" class="tf-form tf-form--group-seperator-dashed">

	<tf-portlet id="portlet-chantier">
		<div class="tf-portlet-header " >
			<span class="title">
			  <a [routerLink]="['/analyses-risque/list']">{{'MENU.HOME' | translate}}</a>
			  <span class="divider">></span>
			  <span class="id-item">{{'MENU.SUB_ANALYSERISQUE.ADD' | translate}}</span>
			</span>
		</div>

		<tf-portlet-body style="flex-direction: row;">

			<div class="col-md-12 col-lg-4 col-xl-3">
				<div class="tf-heading tf-heading--md" style="margin-top: 0;">
					{{'ARS.CHANTIERS.FORM.SEARCH.TITLE' | translate}}
				</div>
				<div class="result-msg mb-4" *ngIf="chantier">
					<span>{{'ARS.CHANTIERS.FORM.SEARCH.RESULT.TEXT1' | translate}}</span> {{'ARS.CHANTIERS.FORM.SEARCH.RESULT.TEXT2' | translate}}
				</div>
				<div class="flex-layout">

					<div class="form-group row">
						<div class="col-md-12">
							<div class="input-group search-input-group">
								<div class="input-group-prepend">
									<span class="input-group-text search-icon-container">
										<mat-icon svgIcon="search"></mat-icon>
									</span>
								</div>
								<input #searchInput type="text" [formControl]="searchControl" class="form-control search-input" name="keyword" placeholder="{{'FILTER.SEARCH_CHANTIER' | translate}}" [matAutocomplete]="auto">
								<mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
									<mat-option *ngFor="let chantier of filteredChantiers | async" [value]="chantier" (click)="initFilteredChantiers()">
										{{chantier.nom}}
									</mat-option>
								</mat-autocomplete>
							</div>
						</div>
					</div>

					<div class="col-md-3 col-lg-4">
						<button class="btn btn-brand btn-search" (click)="searchForChantier()">
							Lancer
						</button>
					</div>
				</div>
			</div>
			<div class="v-divider" *ngIf="chantier"></div>
			<div class="col-md-12 col-lg-8 col-xl-9 search-result-block" *ngIf="chantier">
				<div class="tf-wizard-v4__content" data-tfwizard-type="step-content" data-tfwizard-state="current">
					<div class="tf-form__section tf-form__section--first">
						<div class="tf-wizard-v4__form">
							<div class="row">
								<div class="col-sm-6">
									<div class="row">
										<div class="col-sm">
											<div class="col-xl-12">
												<mat-label>{{'ARS.CHANTIERS.NUMBER' | translate}}</mat-label>
												<input class="form-control" matInput type="text" [value]='chantier?.numero' [readonly]="true"  />
											</div>
											<div class="col-xl-12">
												<mat-label>{{'ARS.CHANTIERS.NAME' | translate}}</mat-label>
												<input class="form-control" matInput type="text" [value]='chantier?.nom' [readonly]="true"  />
											</div>
											<div class="col-xl-12">
												<mat-label>{{'ARS.CHANTIERS.ADRESS' | translate}}</mat-label>
												<input class="form-control" matInput type="text" [value]='chantier?.adresse' [readonly]="true"  />
											</div>
										</div>
										<div class="col-sm">
											<div class="col-xl-12">
												<mat-label>{{'COMMON.POSTCODE.LABEL' | translate}}</mat-label>
												<input class="form-control" matInput type="text" [value]='chantier?.code_postal' [readonly]="true"  />
											</div>
											<div class="col-xl-12">
												<mat-label>{{'COMMON.CITY.LABEL' | translate}}</mat-label>
												<input class="form-control" matInput type="text" [value]='chantier?.ville' [readonly]="true"  />
											</div>
											<div class="col-xl-12">
												<mat-label>{{'COMMON.COUNTRY.LABEL' | translate}}</mat-label>
												<input class="form-control" matInput type="text" [value]='chantier?.pays' [readonly]="true"  />
											</div>
										</div>
									</div>
								</div>
								<div class="v-divider"></div>
								<div class="col-sm-4">
									<div class="col-xl-12">
										<mat-label>{{'ARS.CHANTIERS.EMPLOYEE' | translate}}</mat-label>
										<input class="form-control" matInput type="text" [value]='chantier?.contact' [readonly]="true"  />
									</div>
									<div class="col-xl-12">
										<mat-label>{{'ARS.CHANTIERS.BUDGET' | translate}}</mat-label>
										<input class="form-control" matInput type="text" [value]='chantier?.montant' [readonly]="true"  />
									</div>
									<div class="col-xl-12">
										<mat-label>{{'ARS.CHANTIERS.DATE_DEMARRAGE' | translate}}</mat-label>
										<input class="form-control" matInput type="text" [value]='chantier?.date_demarrage| date:"dd/MM/yyyy"' [readonly]="true"  />
									</div>
								</div>
							</div>
							<div class="row">
							</div>
						</div>
					</div>
				</div>
			</div>
		</tf-portlet-body>
	</tf-portlet>

	<tf-ar-form-1 [arForm]="arForm" [edit]="true"></tf-ar-form-1>

	<tf-ar-form2 [arForm]="arForm" [edit]="true"></tf-ar-form2>
	

	<button mat-raised-button [disabled]="arForm.invalid" class="btn float-right btn-save" (click)="arForm.valid && onSubmit(false)">
		{{'ACTION.SAVE' | translate}}
	</button>

</form>